Дипломный проект.

Сплошной говнокод, лучше не смотрите.
